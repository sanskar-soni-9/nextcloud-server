{"version":3,"file":"files-sidebar.mjs","sources":["../node_modules/fast-xml-parser/src/xmlparser/xmlNode.js","../node_modules/fast-xml-parser/src/xmlparser/DocTypeReader.js","../node_modules/fast-xml-parser/src/xmlparser/OrderedObjParser.js","../node_modules/fast-xml-parser/src/xmlparser/XMLParser.js","../node_modules/fast-xml-parser/src/fxp.js","../apps/files/src/services/FileInfo.js","../apps/files/src/components/LegacyView.vue","../apps/files/src/components/SidebarTab.vue","../apps/systemtags/src/services/files.ts","../apps/systemtags/src/components/SystemTags.vue","../apps/files/src/views/Sidebar.vue","../apps/files/src/services/Sidebar.js","../node_modules/@skjnldsv/sanitize-svg/node_modules/is-svg/index.js","../node_modules/@skjnldsv/sanitize-svg/dist/index.esm.js","../apps/files/src/models/Tab.js","../apps/files/src/sidebar.js"],"sourcesContent":["'use strict';\n\nclass XmlNode{\n  constructor(tagname) {\n    this.tagname = tagname;\n    this.child = []; //nested tags, text, cdata, comments in order\n    this[\":@\"] = {}; //attributes map\n  }\n  add(key,val){\n    // this.child.push( {name : key, val: val, isCdata: isCdata });\n    if(key === \"__proto__\") key = \"#__proto__\";\n    this.child.push( {[key]: val });\n  }\n  addChild(node) {\n    if(node.tagname === \"__proto__\") node.tagname = \"#__proto__\";\n    if(node[\":@\"] && Object.keys(node[\":@\"]).length > 0){\n      this.child.push( { [node.tagname]: node.child, [\":@\"]: node[\":@\"] });\n    }else{\n      this.child.push( { [node.tagname]: node.child });\n    }\n  };\n};\n\n\nmodule.exports = XmlNode;","const util = require('../util');\n\n//TODO: handle comments\nfunction readDocType(xmlData, i){\n    \n    const entities = {};\n    if( xmlData[i + 3] === 'O' &&\n         xmlData[i + 4] === 'C' &&\n         xmlData[i + 5] === 'T' &&\n         xmlData[i + 6] === 'Y' &&\n         xmlData[i + 7] === 'P' &&\n         xmlData[i + 8] === 'E')\n    {    \n        i = i+9;\n        let angleBracketsCount = 1;\n        let hasBody = false, comment = false;\n        let exp = \"\";\n        for(;i<xmlData.length;i++){\n            if (xmlData[i] === '<' && !comment) { //Determine the tag type\n                if( hasBody && isEntity(xmlData, i)){\n                    i += 7; \n                    [entityName, val,i] = readEntityExp(xmlData,i+1);\n                    if(val.indexOf(\"&\") === -1) //Parameter entities are not supported\n                        entities[ validateEntityName(entityName) ] = {\n                            regx : RegExp( `&${entityName};`,\"g\"),\n                            val: val\n                        };\n                }\n                else if( hasBody && isElement(xmlData, i))  i += 8;//Not supported\n                else if( hasBody && isAttlist(xmlData, i))  i += 8;//Not supported\n                else if( hasBody && isNotation(xmlData, i)) i += 9;//Not supported\n                else if( isComment)                         comment = true;\n                else                                        throw new Error(\"Invalid DOCTYPE\");\n\n                angleBracketsCount++;\n                exp = \"\";\n            } else if (xmlData[i] === '>') { //Read tag content\n                if(comment){\n                    if( xmlData[i - 1] === \"-\" && xmlData[i - 2] === \"-\"){\n                        comment = false;\n                        angleBracketsCount--;\n                    }\n                }else{\n                    angleBracketsCount--;\n                }\n                if (angleBracketsCount === 0) {\n                  break;\n                }\n            }else if( xmlData[i] === '['){\n                hasBody = true;\n            }else{\n                exp += xmlData[i];\n            }\n        }\n        if(angleBracketsCount !== 0){\n            throw new Error(`Unclosed DOCTYPE`);\n        }\n    }else{\n        throw new Error(`Invalid Tag instead of DOCTYPE`);\n    }\n    return {entities, i};\n}\n\nfunction readEntityExp(xmlData,i){\n    //External entities are not supported\n    //    <!ENTITY ext SYSTEM \"http://normal-website.com\" >\n\n    //Parameter entities are not supported\n    //    <!ENTITY entityname \"&anotherElement;\">\n\n    //Internal entities are supported\n    //    <!ENTITY entityname \"replacement text\">\n    \n    //read EntityName\n    let entityName = \"\";\n    for (; i < xmlData.length && (xmlData[i] !== \"'\" && xmlData[i] !== '\"' ); i++) {\n        // if(xmlData[i] === \" \") continue;\n        // else \n        entityName += xmlData[i];\n    }\n    entityName = entityName.trim();\n    if(entityName.indexOf(\" \") !== -1) throw new Error(\"External entites are not supported\");\n\n    //read Entity Value\n    const startChar = xmlData[i++];\n    let val = \"\"\n    for (; i < xmlData.length && xmlData[i] !== startChar ; i++) {\n        val += xmlData[i];\n    }\n    return [entityName, val, i];\n}\n\nfunction isComment(xmlData, i){\n    if(xmlData[i+1] === '!' &&\n    xmlData[i+2] === '-' &&\n    xmlData[i+3] === '-') return true\n    return false\n}\nfunction isEntity(xmlData, i){\n    if(xmlData[i+1] === '!' &&\n    xmlData[i+2] === 'E' &&\n    xmlData[i+3] === 'N' &&\n    xmlData[i+4] === 'T' &&\n    xmlData[i+5] === 'I' &&\n    xmlData[i+6] === 'T' &&\n    xmlData[i+7] === 'Y') return true\n    return false\n}\nfunction isElement(xmlData, i){\n    if(xmlData[i+1] === '!' &&\n    xmlData[i+2] === 'E' &&\n    xmlData[i+3] === 'L' &&\n    xmlData[i+4] === 'E' &&\n    xmlData[i+5] === 'M' &&\n    xmlData[i+6] === 'E' &&\n    xmlData[i+7] === 'N' &&\n    xmlData[i+8] === 'T') return true\n    return false\n}\n\nfunction isAttlist(xmlData, i){\n    if(xmlData[i+1] === '!' &&\n    xmlData[i+2] === 'A' &&\n    xmlData[i+3] === 'T' &&\n    xmlData[i+4] === 'T' &&\n    xmlData[i+5] === 'L' &&\n    xmlData[i+6] === 'I' &&\n    xmlData[i+7] === 'S' &&\n    xmlData[i+8] === 'T') return true\n    return false\n}\nfunction isNotation(xmlData, i){\n    if(xmlData[i+1] === '!' &&\n    xmlData[i+2] === 'N' &&\n    xmlData[i+3] === 'O' &&\n    xmlData[i+4] === 'T' &&\n    xmlData[i+5] === 'A' &&\n    xmlData[i+6] === 'T' &&\n    xmlData[i+7] === 'I' &&\n    xmlData[i+8] === 'O' &&\n    xmlData[i+9] === 'N') return true\n    return false\n}\n\nfunction validateEntityName(name){\n    if (util.isName(name))\n\treturn name;\n    else\n        throw new Error(`Invalid entity name ${name}`);\n}\n\nmodule.exports = readDocType;\n","'use strict';\n///@ts-check\n\nconst util = require('../util');\nconst xmlNode = require('./xmlNode');\nconst readDocType = require(\"./DocTypeReader\");\nconst toNumber = require(\"strnum\");\n\n// const regx =\n//   '<((!\\\\[CDATA\\\\[([\\\\s\\\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\\\/)(NAME)\\\\s*>))([^<]*)'\n//   .replace(/NAME/g, util.nameRegexp);\n\n//const tagsRegx = new RegExp(\"<(\\\\/?[\\\\w:\\\\-\\._]+)([^>]*)>(\\\\s*\"+cdataRegx+\")*([^<]+)?\",\"g\");\n//const tagsRegx = new RegExp(\"<(\\\\/?)((\\\\w*:)?([\\\\w:\\\\-\\._]+))([^>]*)>([^<]*)(\"+cdataRegx+\"([^<]*))*([^<]+)?\",\"g\");\n\nclass OrderedObjParser{\n  constructor(options){\n    this.options = options;\n    this.currentNode = null;\n    this.tagsNodeStack = [];\n    this.docTypeEntities = {};\n    this.lastEntities = {\n      \"apos\" : { regex: /&(apos|#39|#x27);/g, val : \"'\"},\n      \"gt\" : { regex: /&(gt|#62|#x3E);/g, val : \">\"},\n      \"lt\" : { regex: /&(lt|#60|#x3C);/g, val : \"<\"},\n      \"quot\" : { regex: /&(quot|#34|#x22);/g, val : \"\\\"\"},\n    };\n    this.ampEntity = { regex: /&(amp|#38|#x26);/g, val : \"&\"};\n    this.htmlEntities = {\n      \"space\": { regex: /&(nbsp|#160);/g, val: \" \" },\n      // \"lt\" : { regex: /&(lt|#60);/g, val: \"<\" },\n      // \"gt\" : { regex: /&(gt|#62);/g, val: \">\" },\n      // \"amp\" : { regex: /&(amp|#38);/g, val: \"&\" },\n      // \"quot\" : { regex: /&(quot|#34);/g, val: \"\\\"\" },\n      // \"apos\" : { regex: /&(apos|#39);/g, val: \"'\" },\n      \"cent\" : { regex: /&(cent|#162);/g, val: \"¢\" },\n      \"pound\" : { regex: /&(pound|#163);/g, val: \"£\" },\n      \"yen\" : { regex: /&(yen|#165);/g, val: \"¥\" },\n      \"euro\" : { regex: /&(euro|#8364);/g, val: \"€\" },\n      \"copyright\" : { regex: /&(copy|#169);/g, val: \"©\" },\n      \"reg\" : { regex: /&(reg|#174);/g, val: \"®\" },\n      \"inr\" : { regex: /&(inr|#8377);/g, val: \"₹\" },\n    };\n    this.addExternalEntities = addExternalEntities;\n    this.parseXml = parseXml;\n    this.parseTextData = parseTextData;\n    this.resolveNameSpace = resolveNameSpace;\n    this.buildAttributesMap = buildAttributesMap;\n    this.isItStopNode = isItStopNode;\n    this.replaceEntitiesValue = replaceEntitiesValue;\n    this.readStopNodeData = readStopNodeData;\n    this.saveTextToParentTag = saveTextToParentTag;\n    this.addChild = addChild;\n  }\n\n}\n\nfunction addExternalEntities(externalEntities){\n  const entKeys = Object.keys(externalEntities);\n  for (let i = 0; i < entKeys.length; i++) {\n    const ent = entKeys[i];\n    this.lastEntities[ent] = {\n       regex: new RegExp(\"&\"+ent+\";\",\"g\"),\n       val : externalEntities[ent]\n    }\n  }\n}\n\n/**\n * @param {string} val\n * @param {string} tagName\n * @param {string} jPath\n * @param {boolean} dontTrim\n * @param {boolean} hasAttributes\n * @param {boolean} isLeafNode\n * @param {boolean} escapeEntities\n */\nfunction parseTextData(val, tagName, jPath, dontTrim, hasAttributes, isLeafNode, escapeEntities) {\n  if (val !== undefined) {\n    if (this.options.trimValues && !dontTrim) {\n      val = val.trim();\n    }\n    if(val.length > 0){\n      if(!escapeEntities) val = this.replaceEntitiesValue(val);\n      \n      const newval = this.options.tagValueProcessor(tagName, val, jPath, hasAttributes, isLeafNode);\n      if(newval === null || newval === undefined){\n        //don't parse\n        return val;\n      }else if(typeof newval !== typeof val || newval !== val){\n        //overwrite\n        return newval;\n      }else if(this.options.trimValues){\n        return parseValue(val, this.options.parseTagValue, this.options.numberParseOptions);\n      }else{\n        const trimmedVal = val.trim();\n        if(trimmedVal === val){\n          return parseValue(val, this.options.parseTagValue, this.options.numberParseOptions);\n        }else{\n          return val;\n        }\n      }\n    }\n  }\n}\n\nfunction resolveNameSpace(tagname) {\n  if (this.options.removeNSPrefix) {\n    const tags = tagname.split(':');\n    const prefix = tagname.charAt(0) === '/' ? '/' : '';\n    if (tags[0] === 'xmlns') {\n      return '';\n    }\n    if (tags.length === 2) {\n      tagname = prefix + tags[1];\n    }\n  }\n  return tagname;\n}\n\n//TODO: change regex to capture NS\n//const attrsRegx = new RegExp(\"([\\\\w\\\\-\\\\.\\\\:]+)\\\\s*=\\\\s*(['\\\"])((.|\\n)*?)\\\\2\",\"gm\");\nconst attrsRegx = new RegExp('([^\\\\s=]+)\\\\s*(=\\\\s*([\\'\"])([\\\\s\\\\S]*?)\\\\3)?', 'gm');\n\nfunction buildAttributesMap(attrStr, jPath, tagName) {\n  if (!this.options.ignoreAttributes && typeof attrStr === 'string') {\n    // attrStr = attrStr.replace(/\\r?\\n/g, ' ');\n    //attrStr = attrStr || attrStr.trim();\n\n    const matches = util.getAllMatches(attrStr, attrsRegx);\n    const len = matches.length; //don't make it inline\n    const attrs = {};\n    for (let i = 0; i < len; i++) {\n      const attrName = this.resolveNameSpace(matches[i][1]);\n      let oldVal = matches[i][4];\n      let aName = this.options.attributeNamePrefix + attrName;\n      if (attrName.length) {\n        if (this.options.transformAttributeName) {\n          aName = this.options.transformAttributeName(aName);\n        }\n        if(aName === \"__proto__\") aName  = \"#__proto__\";\n        if (oldVal !== undefined) {\n          if (this.options.trimValues) {\n            oldVal = oldVal.trim();\n          }\n          oldVal = this.replaceEntitiesValue(oldVal);\n          const newVal = this.options.attributeValueProcessor(attrName, oldVal, jPath);\n          if(newVal === null || newVal === undefined){\n            //don't parse\n            attrs[aName] = oldVal;\n          }else if(typeof newVal !== typeof oldVal || newVal !== oldVal){\n            //overwrite\n            attrs[aName] = newVal;\n          }else{\n            //parse\n            attrs[aName] = parseValue(\n              oldVal,\n              this.options.parseAttributeValue,\n              this.options.numberParseOptions\n            );\n          }\n        } else if (this.options.allowBooleanAttributes) {\n          attrs[aName] = true;\n        }\n      }\n    }\n    if (!Object.keys(attrs).length) {\n      return;\n    }\n    if (this.options.attributesGroupName) {\n      const attrCollection = {};\n      attrCollection[this.options.attributesGroupName] = attrs;\n      return attrCollection;\n    }\n    return attrs\n  }\n}\n\nconst parseXml = function(xmlData) {\n  xmlData = xmlData.replace(/\\r\\n?/g, \"\\n\"); //TODO: remove this line\n  const xmlObj = new xmlNode('!xml');\n  let currentNode = xmlObj;\n  let textData = \"\";\n  let jPath = \"\";\n  for(let i=0; i< xmlData.length; i++){//for each char in XML data\n    const ch = xmlData[i];\n    if(ch === '<'){\n      // const nextIndex = i+1;\n      // const _2ndChar = xmlData[nextIndex];\n      if( xmlData[i+1] === '/') {//Closing Tag\n        const closeIndex = findClosingIndex(xmlData, \">\", i, \"Closing Tag is not closed.\")\n        let tagName = xmlData.substring(i+2,closeIndex).trim();\n\n        if(this.options.removeNSPrefix){\n          const colonIndex = tagName.indexOf(\":\");\n          if(colonIndex !== -1){\n            tagName = tagName.substr(colonIndex+1);\n          }\n        }\n\n        if(this.options.transformTagName) {\n          tagName = this.options.transformTagName(tagName);\n        }\n\n        if(currentNode){\n          textData = this.saveTextToParentTag(textData, currentNode, jPath);\n        }\n\n        //check if last tag of nested tag was unpaired tag\n        const lastTagName = jPath.substring(jPath.lastIndexOf(\".\")+1);\n        if(tagName && this.options.unpairedTags.indexOf(tagName) !== -1 ){\n          throw new Error(`Unpaired tag can not be used as closing tag: </${tagName}>`);\n        }\n        let propIndex = 0\n        if(lastTagName && this.options.unpairedTags.indexOf(lastTagName) !== -1 ){\n          propIndex = jPath.lastIndexOf('.', jPath.lastIndexOf('.')-1)\n          this.tagsNodeStack.pop();\n        }else{\n          propIndex = jPath.lastIndexOf(\".\");\n        }\n        jPath = jPath.substring(0, propIndex);\n\n        currentNode = this.tagsNodeStack.pop();//avoid recursion, set the parent tag scope\n        textData = \"\";\n        i = closeIndex;\n      } else if( xmlData[i+1] === '?') {\n\n        let tagData = readTagExp(xmlData,i, false, \"?>\");\n        if(!tagData) throw new Error(\"Pi Tag is not closed.\");\n\n        textData = this.saveTextToParentTag(textData, currentNode, jPath);\n        if( (this.options.ignoreDeclaration && tagData.tagName === \"?xml\") || this.options.ignorePiTags){\n\n        }else{\n  \n          const childNode = new xmlNode(tagData.tagName);\n          childNode.add(this.options.textNodeName, \"\");\n          \n          if(tagData.tagName !== tagData.tagExp && tagData.attrExpPresent){\n            childNode[\":@\"] = this.buildAttributesMap(tagData.tagExp, jPath, tagData.tagName);\n          }\n          this.addChild(currentNode, childNode, jPath)\n\n        }\n\n\n        i = tagData.closeIndex + 1;\n      } else if(xmlData.substr(i + 1, 3) === '!--') {\n        const endIndex = findClosingIndex(xmlData, \"-->\", i+4, \"Comment is not closed.\")\n        if(this.options.commentPropName){\n          const comment = xmlData.substring(i + 4, endIndex - 2);\n\n          textData = this.saveTextToParentTag(textData, currentNode, jPath);\n\n          currentNode.add(this.options.commentPropName, [ { [this.options.textNodeName] : comment } ]);\n        }\n        i = endIndex;\n      } else if( xmlData.substr(i + 1, 2) === '!D') {\n        const result = readDocType(xmlData, i);\n        this.docTypeEntities = result.entities;\n        i = result.i;\n      }else if(xmlData.substr(i + 1, 2) === '![') {\n        const closeIndex = findClosingIndex(xmlData, \"]]>\", i, \"CDATA is not closed.\") - 2;\n        const tagExp = xmlData.substring(i + 9,closeIndex);\n\n        textData = this.saveTextToParentTag(textData, currentNode, jPath);\n\n        let val = this.parseTextData(tagExp, currentNode.tagname, jPath, true, false, true, true);\n        if(val == undefined) val = \"\";\n\n        //cdata should be set even if it is 0 length string\n        if(this.options.cdataPropName){\n          currentNode.add(this.options.cdataPropName, [ { [this.options.textNodeName] : tagExp } ]);\n        }else{\n          currentNode.add(this.options.textNodeName, val);\n        }\n        \n        i = closeIndex + 2;\n      }else {//Opening tag\n        let result = readTagExp(xmlData,i, this.options.removeNSPrefix);\n        let tagName= result.tagName;\n        const rawTagName = result.rawTagName;\n        let tagExp = result.tagExp;\n        let attrExpPresent = result.attrExpPresent;\n        let closeIndex = result.closeIndex;\n\n        if (this.options.transformTagName) {\n          tagName = this.options.transformTagName(tagName);\n        }\n        \n        //save text as child node\n        if (currentNode && textData) {\n          if(currentNode.tagname !== '!xml'){\n            //when nested tag is found\n            textData = this.saveTextToParentTag(textData, currentNode, jPath, false);\n          }\n        }\n\n        //check if last tag was unpaired tag\n        const lastTag = currentNode;\n        if(lastTag && this.options.unpairedTags.indexOf(lastTag.tagname) !== -1 ){\n          currentNode = this.tagsNodeStack.pop();\n          jPath = jPath.substring(0, jPath.lastIndexOf(\".\"));\n        }\n        if(tagName !== xmlObj.tagname){\n          jPath += jPath ? \".\" + tagName : tagName;\n        }\n        if (this.isItStopNode(this.options.stopNodes, jPath, tagName)) {\n          let tagContent = \"\";\n          //self-closing tag\n          if(tagExp.length > 0 && tagExp.lastIndexOf(\"/\") === tagExp.length - 1){\n            i = result.closeIndex;\n          }\n          //unpaired tag\n          else if(this.options.unpairedTags.indexOf(tagName) !== -1){\n            i = result.closeIndex;\n          }\n          //normal tag\n          else{\n            //read until closing tag is found\n            const result = this.readStopNodeData(xmlData, rawTagName, closeIndex + 1);\n            if(!result) throw new Error(`Unexpected end of ${rawTagName}`);\n            i = result.i;\n            tagContent = result.tagContent;\n          }\n\n          const childNode = new xmlNode(tagName);\n          if(tagName !== tagExp && attrExpPresent){\n            childNode[\":@\"] = this.buildAttributesMap(tagExp, jPath, tagName);\n          }\n          if(tagContent) {\n            tagContent = this.parseTextData(tagContent, tagName, jPath, true, attrExpPresent, true, true);\n          }\n          \n          jPath = jPath.substr(0, jPath.lastIndexOf(\".\"));\n          childNode.add(this.options.textNodeName, tagContent);\n          \n          this.addChild(currentNode, childNode, jPath)\n        }else{\n  //selfClosing tag\n          if(tagExp.length > 0 && tagExp.lastIndexOf(\"/\") === tagExp.length - 1){\n            if(tagName[tagName.length - 1] === \"/\"){ //remove trailing '/'\n              tagName = tagName.substr(0, tagName.length - 1);\n              jPath = jPath.substr(0, jPath.length - 1);\n              tagExp = tagName;\n            }else{\n              tagExp = tagExp.substr(0, tagExp.length - 1);\n            }\n            \n            if(this.options.transformTagName) {\n              tagName = this.options.transformTagName(tagName);\n            }\n\n            const childNode = new xmlNode(tagName);\n            if(tagName !== tagExp && attrExpPresent){\n              childNode[\":@\"] = this.buildAttributesMap(tagExp, jPath, tagName);\n            }\n            this.addChild(currentNode, childNode, jPath)\n            jPath = jPath.substr(0, jPath.lastIndexOf(\".\"));\n          }\n    //opening tag\n          else{\n            const childNode = new xmlNode( tagName);\n            this.tagsNodeStack.push(currentNode);\n            \n            if(tagName !== tagExp && attrExpPresent){\n              childNode[\":@\"] = this.buildAttributesMap(tagExp, jPath, tagName);\n            }\n            this.addChild(currentNode, childNode, jPath)\n            currentNode = childNode;\n          }\n          textData = \"\";\n          i = closeIndex;\n        }\n      }\n    }else{\n      textData += xmlData[i];\n    }\n  }\n  return xmlObj.child;\n}\n\nfunction addChild(currentNode, childNode, jPath){\n  const result = this.options.updateTag(childNode.tagname, jPath, childNode[\":@\"])\n  if(result === false){\n  }else if(typeof result === \"string\"){\n    childNode.tagname = result\n    currentNode.addChild(childNode);\n  }else{\n    currentNode.addChild(childNode);\n  }\n}\n\nconst replaceEntitiesValue = function(val){\n\n  if(this.options.processEntities){\n    for(let entityName in this.docTypeEntities){\n      const entity = this.docTypeEntities[entityName];\n      val = val.replace( entity.regx, entity.val);\n    }\n    for(let entityName in this.lastEntities){\n      const entity = this.lastEntities[entityName];\n      val = val.replace( entity.regex, entity.val);\n    }\n    if(this.options.htmlEntities){\n      for(let entityName in this.htmlEntities){\n        const entity = this.htmlEntities[entityName];\n        val = val.replace( entity.regex, entity.val);\n      }\n    }\n    val = val.replace( this.ampEntity.regex, this.ampEntity.val);\n  }\n  return val;\n}\nfunction saveTextToParentTag(textData, currentNode, jPath, isLeafNode) {\n  if (textData) { //store previously collected data as textNode\n    if(isLeafNode === undefined) isLeafNode = Object.keys(currentNode.child).length === 0\n    \n    textData = this.parseTextData(textData,\n      currentNode.tagname,\n      jPath,\n      false,\n      currentNode[\":@\"] ? Object.keys(currentNode[\":@\"]).length !== 0 : false,\n      isLeafNode);\n\n    if (textData !== undefined && textData !== \"\")\n      currentNode.add(this.options.textNodeName, textData);\n    textData = \"\";\n  }\n  return textData;\n}\n\n//TODO: use jPath to simplify the logic\n/**\n * \n * @param {string[]} stopNodes \n * @param {string} jPath\n * @param {string} currentTagName \n */\nfunction isItStopNode(stopNodes, jPath, currentTagName){\n  const allNodesExp = \"*.\" + currentTagName;\n  for (const stopNodePath in stopNodes) {\n    const stopNodeExp = stopNodes[stopNodePath];\n    if( allNodesExp === stopNodeExp || jPath === stopNodeExp  ) return true;\n  }\n  return false;\n}\n\n/**\n * Returns the tag Expression and where it is ending handling single-double quotes situation\n * @param {string} xmlData \n * @param {number} i starting index\n * @returns \n */\nfunction tagExpWithClosingIndex(xmlData, i, closingChar = \">\"){\n  let attrBoundary;\n  let tagExp = \"\";\n  for (let index = i; index < xmlData.length; index++) {\n    let ch = xmlData[index];\n    if (attrBoundary) {\n        if (ch === attrBoundary) attrBoundary = \"\";//reset\n    } else if (ch === '\"' || ch === \"'\") {\n        attrBoundary = ch;\n    } else if (ch === closingChar[0]) {\n      if(closingChar[1]){\n        if(xmlData[index + 1] === closingChar[1]){\n          return {\n            data: tagExp,\n            index: index\n          }\n        }\n      }else{\n        return {\n          data: tagExp,\n          index: index\n        }\n      }\n    } else if (ch === '\\t') {\n      ch = \" \"\n    }\n    tagExp += ch;\n  }\n}\n\nfunction findClosingIndex(xmlData, str, i, errMsg){\n  const closingIndex = xmlData.indexOf(str, i);\n  if(closingIndex === -1){\n    throw new Error(errMsg)\n  }else{\n    return closingIndex + str.length - 1;\n  }\n}\n\nfunction readTagExp(xmlData,i, removeNSPrefix, closingChar = \">\"){\n  const result = tagExpWithClosingIndex(xmlData, i+1, closingChar);\n  if(!result) return;\n  let tagExp = result.data;\n  const closeIndex = result.index;\n  const separatorIndex = tagExp.search(/\\s/);\n  let tagName = tagExp;\n  let attrExpPresent = true;\n  if(separatorIndex !== -1){//separate tag name and attributes expression\n    tagName = tagExp.substring(0, separatorIndex);\n    tagExp = tagExp.substring(separatorIndex + 1).trimStart();\n  }\n\n  const rawTagName = tagName;\n  if(removeNSPrefix){\n    const colonIndex = tagName.indexOf(\":\");\n    if(colonIndex !== -1){\n      tagName = tagName.substr(colonIndex+1);\n      attrExpPresent = tagName !== result.data.substr(colonIndex + 1);\n    }\n  }\n\n  return {\n    tagName: tagName,\n    tagExp: tagExp,\n    closeIndex: closeIndex,\n    attrExpPresent: attrExpPresent,\n    rawTagName: rawTagName,\n  }\n}\n/**\n * find paired tag for a stop node\n * @param {string} xmlData \n * @param {string} tagName \n * @param {number} i \n */\nfunction readStopNodeData(xmlData, tagName, i){\n  const startIndex = i;\n  // Starting at 1 since we already have an open tag\n  let openTagCount = 1;\n\n  for (; i < xmlData.length; i++) {\n    if( xmlData[i] === \"<\"){ \n      if (xmlData[i+1] === \"/\") {//close tag\n          const closeIndex = findClosingIndex(xmlData, \">\", i, `${tagName} is not closed`);\n          let closeTagName = xmlData.substring(i+2,closeIndex).trim();\n          if(closeTagName === tagName){\n            openTagCount--;\n            if (openTagCount === 0) {\n              return {\n                tagContent: xmlData.substring(startIndex, i),\n                i : closeIndex\n              }\n            }\n          }\n          i=closeIndex;\n        } else if(xmlData[i+1] === '?') { \n          const closeIndex = findClosingIndex(xmlData, \"?>\", i+1, \"StopNode is not closed.\")\n          i=closeIndex;\n        } else if(xmlData.substr(i + 1, 3) === '!--') { \n          const closeIndex = findClosingIndex(xmlData, \"-->\", i+3, \"StopNode is not closed.\")\n          i=closeIndex;\n        } else if(xmlData.substr(i + 1, 2) === '![') { \n          const closeIndex = findClosingIndex(xmlData, \"]]>\", i, \"StopNode is not closed.\") - 2;\n          i=closeIndex;\n        } else {\n          const tagData = readTagExp(xmlData, i, '>')\n\n          if (tagData) {\n            const openTagName = tagData && tagData.tagName;\n            if (openTagName === tagName && tagData.tagExp[tagData.tagExp.length-1] !== \"/\") {\n              openTagCount++;\n            }\n            i=tagData.closeIndex;\n          }\n        }\n      }\n  }//end for loop\n}\n\nfunction parseValue(val, shouldParse, options) {\n  if (shouldParse && typeof val === 'string') {\n    //console.log(options)\n    const newval = val.trim();\n    if(newval === 'true' ) return true;\n    else if(newval === 'false' ) return false;\n    else return toNumber(val, options);\n  } else {\n    if (util.isExist(val)) {\n      return val;\n    } else {\n      return '';\n    }\n  }\n}\n\n\nmodule.exports = OrderedObjParser;\n","const { buildOptions} = require(\"./OptionsBuilder\");\nconst OrderedObjParser = require(\"./OrderedObjParser\");\nconst { prettify} = require(\"./node2json\");\nconst validator = require('../validator');\n\nclass XMLParser{\n    \n    constructor(options){\n        this.externalEntities = {};\n        this.options = buildOptions(options);\n        \n    }\n    /**\n     * Parse XML dats to JS object \n     * @param {string|Buffer} xmlData \n     * @param {boolean|Object} validationOption \n     */\n    parse(xmlData,validationOption){\n        if(typeof xmlData === \"string\"){\n        }else if( xmlData.toString){\n            xmlData = xmlData.toString();\n        }else{\n            throw new Error(\"XML data is accepted in String or Bytes[] form.\")\n        }\n        if( validationOption){\n            if(validationOption === true) validationOption = {}; //validate with default options\n            \n            const result = validator.validate(xmlData, validationOption);\n            if (result !== true) {\n              throw Error( `${result.err.msg}:${result.err.line}:${result.err.col}` )\n            }\n          }\n        const orderedObjParser = new OrderedObjParser(this.options);\n        orderedObjParser.addExternalEntities(this.externalEntities);\n        const orderedResult = orderedObjParser.parseXml(xmlData);\n        if(this.options.preserveOrder || orderedResult === undefined) return orderedResult;\n        else return prettify(orderedResult, this.options);\n    }\n\n    /**\n     * Add Entity which is not by default supported by this library\n     * @param {string} key \n     * @param {string} value \n     */\n    addEntity(key, value){\n        if(value.indexOf(\"&\") !== -1){\n            throw new Error(\"Entity value can't have '&'\")\n        }else if(key.indexOf(\"&\") !== -1 || key.indexOf(\";\") !== -1){\n            throw new Error(\"An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'\")\n        }else if(value === \"&\"){\n            throw new Error(\"An entity with value '&' is not permitted\");\n        }else{\n            this.externalEntities[key] = value;\n        }\n    }\n}\n\nmodule.exports = XMLParser;","'use strict';\n\nconst validator = require('./validator');\nconst XMLParser = require('./xmlparser/XMLParser');\nconst XMLBuilder = require('./xmlbuilder/json2xml');\n\nmodule.exports = {\n  XMLParser: XMLParser,\n  XMLValidator: validator,\n  XMLBuilder: XMLBuilder\n}","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport axios from '@nextcloud/axios'\nimport { davGetDefaultPropfind } from '@nextcloud/files'\n\n/**\n * @param {any} url -\n */\nexport default async function(url) {\n\tconst response = await axios({\n\t\tmethod: 'PROPFIND',\n\t\turl,\n\t\tdata: davGetDefaultPropfind(),\n\t})\n\n\t// TODO: create new parser or use cdav-lib when available\n\tconst file = OC.Files.getClient()._client.parseMultiStatus(response.data)\n\t// TODO: create new parser or use cdav-lib when available\n\tconst fileInfo = OC.Files.getClient()._parseFileInfo(file[0])\n\n\t// TODO remove when no more legacy backbone is used\n\tfileInfo.get = (key) => fileInfo[key]\n\tfileInfo.isDirectory = () => fileInfo.mimetype === 'httpd/unix-directory'\n\n\treturn fileInfo\n}\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<div />\n</template>\n<script>\nexport default {\n\tname: 'LegacyView',\n\tprops: {\n\t\tcomponent: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tfileInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t\trequired: true,\n\t\t},\n\t},\n\twatch: {\n\t\tfileInfo(fileInfo) {\n\t\t\t// update the backbone model FileInfo\n\t\t\tthis.setFileInfo(fileInfo)\n\t\t},\n\t},\n\tmounted() {\n\t\t// append the backbone element and set the FileInfo\n\t\tthis.component.$el.replaceAll(this.$el)\n\t\tthis.setFileInfo(this.fileInfo)\n\t},\n\tmethods: {\n\t\tsetFileInfo(fileInfo) {\n\t\t\tthis.component.setFileInfo(new OCA.Files.FileInfoModel(fileInfo))\n\t\t},\n\t},\n}\n</script>\n<style>\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<NcAppSidebarTab :id=\"id\"\n\t\tref=\"tab\"\n\t\t:name=\"name\"\n\t\t:icon=\"icon\"\n\t\t@bottomReached=\"onScrollBottomReached\">\n\t\t<template #icon>\n\t\t\t<slot name=\"icon\" />\n\t\t</template>\n\t\t<!-- Fallback loading -->\n\t\t<NcEmptyContent v-if=\"loading\" icon=\"icon-loading\" />\n\n\t\t<!-- Using a dummy div as Vue mount replace the element directly\n\t\t\tIt does NOT append to the content -->\n\t\t<div ref=\"mount\" />\n\t</NcAppSidebarTab>\n</template>\n\n<script>\nimport NcAppSidebarTab from '@nextcloud/vue/dist/Components/NcAppSidebarTab.js'\nimport NcEmptyContent from '@nextcloud/vue/dist/Components/NcEmptyContent.js'\n\nexport default {\n\tname: 'SidebarTab',\n\n\tcomponents: {\n\t\tNcAppSidebarTab,\n\t\tNcEmptyContent,\n\t},\n\n\tprops: {\n\t\tfileInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t\trequired: true,\n\t\t},\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tname: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ticon: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\n\t\t/**\n\t\t * Lifecycle methods.\n\t\t * They are prefixed with `on` to avoid conflict with Vue\n\t\t * methods like this.destroy\n\t\t */\n\t\tonMount: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\tonUpdate: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\tonDestroy: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\tonScrollBottomReached: {\n\t\t\ttype: Function,\n\t\t\tdefault: () => {},\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tloading: true,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t// TODO: implement a better way to force pass a prop from Sidebar\n\t\tactiveTab() {\n\t\t\treturn this.$parent.activeTab\n\t\t},\n\t},\n\n\twatch: {\n\t\tasync fileInfo(newFile, oldFile) {\n\t\t\t// Update fileInfo on change\n\t\t\tif (newFile.id !== oldFile.id) {\n\t\t\t\tthis.loading = true\n\t\t\t\tawait this.onUpdate(this.fileInfo)\n\t\t\t\tthis.loading = false\n\t\t\t}\n\t\t},\n\t},\n\n\tasync mounted() {\n\t\tthis.loading = true\n\t\t// Mount the tab:  mounting point,   fileInfo,      vue context\n\t\tawait this.onMount(this.$refs.mount, this.fileInfo, this.$refs.tab)\n\t\tthis.loading = false\n\t},\n\n\tasync beforeDestroy() {\n\t\t// unmount the tab\n\t\tawait this.onDestroy()\n\t},\n}\n</script>\n","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport type { FileStat, ResponseDataDetailed } from 'webdav'\nimport type { ServerTagWithId, Tag, TagWithId } from '../types.js'\n\nimport { davClient } from './davClient.js'\nimport { createTag, fetchTagsPayload } from './api.js'\nimport { formatTag, parseTags } from '../utils.js'\nimport { logger } from '../logger.js'\n\nexport const fetchTagsForFile = async (fileId: number): Promise<TagWithId[]> => {\n\tconst path = '/systemtags-relations/files/' + fileId\n\ttry {\n\t\tconst { data: tags } = await davClient.getDirectoryContents(path, {\n\t\t\tdata: fetchTagsPayload,\n\t\t\tdetails: true,\n\t\t\tglob: '/systemtags-relations/files/*/*', // Filter out first empty tag\n\t\t}) as ResponseDataDetailed<Required<FileStat>[]>\n\t\treturn parseTags(tags)\n\t} catch (error) {\n\t\tlogger.error(t('systemtags', 'Failed to load tags for file'), { error })\n\t\tthrow new Error(t('systemtags', 'Failed to load tags for file'))\n\t}\n}\n\n/**\n * @return created tag id\n */\nexport const createTagForFile = async (tag: Tag, fileId: number): Promise<number> => {\n\tconst tagToCreate = formatTag(tag)\n\tconst tagId = await createTag(tagToCreate)\n\tconst tagToSet: ServerTagWithId = {\n\t\t...tagToCreate,\n\t\tid: tagId,\n\t}\n\tawait setTagForFile(tagToSet, fileId)\n\treturn tagToSet.id\n}\n\nexport const setTagForFile = async (tag: TagWithId | ServerTagWithId, fileId: number): Promise<void> => {\n\tconst path = '/systemtags-relations/files/' + fileId + '/' + tag.id\n\tconst tagToPut = formatTag(tag)\n\ttry {\n\t\tawait davClient.customRequest(path, {\n\t\t\tmethod: 'PUT',\n\t\t\tdata: tagToPut,\n\t\t})\n\t} catch (error) {\n\t\tlogger.error(t('systemtags', 'Failed to set tag for file'), { error })\n\t\tthrow new Error(t('systemtags', 'Failed to set tag for file'))\n\t}\n}\n\nexport const deleteTagForFile = async (tag: TagWithId, fileId: number): Promise<void> => {\n\tconst path = '/systemtags-relations/files/' + fileId + '/' + tag.id\n\ttry {\n\t\tawait davClient.deleteFile(path)\n\t} catch (error) {\n\t\tlogger.error(t('systemtags', 'Failed to delete tag for file'), { error })\n\t\tthrow new Error(t('systemtags', 'Failed to delete tag for file'))\n\t}\n}\n","<!--\n  - SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<div class=\"system-tags\">\n\t\t<NcLoadingIcon v-if=\"loadingTags\"\n\t\t\t:name=\"t('systemtags', 'Loading collaborative tags …')\"\n\t\t\t:size=\"32\" />\n\t\t<template v-else>\n\t\t\t<NcSelectTags class=\"system-tags__select\"\n\t\t\t\t:input-label=\"t('systemtags', 'Search or create collaborative tags')\"\n\t\t\t\t:placeholder=\"t('systemtags', 'Collaborative tags …')\"\n\t\t\t\t:options=\"sortedTags\"\n\t\t\t\t:value=\"selectedTags\"\n\t\t\t\t:create-option=\"createOption\"\n\t\t\t\t:taggable=\"true\"\n\t\t\t\t:passthru=\"true\"\n\t\t\t\t:fetch-tags=\"false\"\n\t\t\t\t:loading=\"loading\"\n\t\t\t\t@input=\"handleInput\"\n\t\t\t\t@option:selected=\"handleSelect\"\n\t\t\t\t@option:created=\"handleCreate\"\n\t\t\t\t@option:deselected=\"handleDeselect\">\n\t\t\t\t<template #no-options>\n\t\t\t\t\t{{ t('systemtags', 'No tags to select, type to create a new tag') }}\n\t\t\t\t</template>\n\t\t\t</NcSelectTags>\n\t\t</template>\n\t</div>\n</template>\n\n<script lang=\"ts\">\n// FIXME Vue TypeScript ESLint errors\n/* eslint-disable */\nimport Vue from 'vue'\nimport NcLoadingIcon from '@nextcloud/vue/dist/Components/NcLoadingIcon.js'\nimport NcSelectTags from '@nextcloud/vue/dist/Components/NcSelectTags.js'\n\nimport { translate as t } from '@nextcloud/l10n'\nimport { showError } from '@nextcloud/dialogs'\n\nimport { defaultBaseTag } from '../utils.js'\nimport { fetchLastUsedTagIds, fetchTags } from '../services/api.js'\nimport {\n\tcreateTagForFile,\n\tdeleteTagForFile,\n\tfetchTagsForFile,\n\tsetTagForFile,\n} from '../services/files.js'\n\nimport type { Tag, TagWithId } from '../types.js'\n\nexport default Vue.extend({\n\tname: 'SystemTags',\n\n\tcomponents: {\n\t\tNcLoadingIcon,\n\t\tNcSelectTags,\n\t},\n\n\tprops: {\n\t\tfileId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tsortedTags: [] as TagWithId[],\n\t\t\tselectedTags: [] as TagWithId[],\n\t\t\tloadingTags: false,\n\t\t\tloading: false,\n\t\t}\n\t},\n\n\tasync created() {\n\t\ttry {\n\t\t\tconst tags = await fetchTags()\n\t\t\tconst lastUsedOrder = await fetchLastUsedTagIds()\n\n\t\t\tconst lastUsedTags: TagWithId[] = []\n\t\t\tconst remainingTags: TagWithId[] = []\n\n\t\t\tfor (const tag of tags) {\n\t\t\t\tif (lastUsedOrder.includes(tag.id)) {\n\t\t\t\t\tlastUsedTags.push(tag)\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\tremainingTags.push(tag)\n\t\t\t}\n\n\t\t\tconst sortByLastUsed = (a: TagWithId, b: TagWithId) => {\n\t\t\t\treturn lastUsedOrder.indexOf(a.id) - lastUsedOrder.indexOf(b.id)\n\t\t\t}\n\t\t\tlastUsedTags.sort(sortByLastUsed)\n\n\t\t\tthis.sortedTags = [...lastUsedTags, ...remainingTags]\n\t\t} catch (error) {\n\t\t\tshowError(t('systemtags', 'Failed to load tags'))\n\t\t}\n\t},\n\n\twatch: {\n\t\tfileId: {\n\t\t\timmediate: true,\n\t\t\tasync handler() {\n\t\t\t\tthis.loadingTags = true\n\t\t\t\ttry {\n\t\t\t\t\tthis.selectedTags = await fetchTagsForFile(this.fileId)\n\t\t\t\t\tthis.$emit('has-tags', this.selectedTags.length > 0)\n\t\t\t\t} catch (error) {\n\t\t\t\t\tshowError(t('systemtags', 'Failed to load selected tags'))\n\t\t\t\t}\n\t\t\t\tthis.loadingTags = false\n\t\t\t},\n\t\t},\n\t},\n\n\tmethods: {\n\t\tt,\n\n\t\tcreateOption(newDisplayName: string): Tag {\n\t\t\tfor (const tag of this.sortedTags) {\n\t\t\t\tconst { id, displayName, ...baseTag } = tag\n\t\t\t\tif (\n\t\t\t\t\tdisplayName === newDisplayName\n\t\t\t\t\t&& Object.entries(baseTag)\n\t\t\t\t\t\t.every(([key, value]) => defaultBaseTag[key] === value)\n\t\t\t\t) {\n\t\t\t\t\t// Return existing tag to prevent vue-select from thinking the tags are different and showing duplicate options\n\t\t\t\t\treturn tag\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...defaultBaseTag,\n\t\t\t\tdisplayName: newDisplayName,\n\t\t\t}\n\t\t},\n\n\t\thandleInput(selectedTags: Tag[]) {\n\t\t\t/**\n\t\t\t * Filter out tags with no id to prevent duplicate selected options\n\t\t\t *\n\t\t\t * Created tags are added programmatically by `handleCreate()` with\n\t\t\t * their respective ids returned from the server\n\t\t\t */\n\t\t\tthis.selectedTags = selectedTags.filter(selectedTag => Boolean(selectedTag.id)) as TagWithId[]\n\t\t},\n\n\t\tasync handleSelect(tags: Tag[]) {\n\t\t\tconst lastTag = tags[tags.length - 1]\n\t\t\tif (!lastTag.id) {\n\t\t\t\t// Ignore created tags handled by `handleCreate()`\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst selectedTag = lastTag as TagWithId\n\t\t\tthis.loading = true\n\t\t\ttry {\n\t\t\t\tawait setTagForFile(selectedTag, this.fileId)\n\t\t\t\tconst sortToFront = (a: TagWithId, b: TagWithId) => {\n\t\t\t\t\tif (a.id === selectedTag.id) {\n\t\t\t\t\t\treturn -1\n\t\t\t\t\t} else if (b.id === selectedTag.id) {\n\t\t\t\t\t\treturn 1\n\t\t\t\t\t}\n\t\t\t\t\treturn 0\n\t\t\t\t}\n\t\t\t\tthis.sortedTags.sort(sortToFront)\n\t\t\t} catch (error) {\n\t\t\t\tshowError(t('systemtags', 'Failed to select tag'))\n\t\t\t}\n\t\t\tthis.loading = false\n\t\t},\n\n\t\tasync handleCreate(tag: Tag) {\n\t\t\tthis.loading = true\n\t\t\ttry {\n\t\t\t\tconst id = await createTagForFile(tag, this.fileId)\n\t\t\t\tconst createdTag = { ...tag, id }\n\t\t\t\tthis.sortedTags.unshift(createdTag)\n\t\t\t\tthis.selectedTags.push(createdTag)\n\t\t\t} catch (error) {\n\t\t\t\tshowError(t('systemtags', 'Failed to create tag'))\n\t\t\t}\n\t\t\tthis.loading = false\n\t\t},\n\n\t\tasync handleDeselect(tag: TagWithId) {\n\t\t\tthis.loading = true\n\t\t\ttry {\n\t\t\t\tawait deleteTagForFile(tag, this.fileId)\n\t\t\t} catch (error) {\n\t\t\t\tshowError(t('systemtags', 'Failed to delete tag'))\n\t\t\t}\n\t\t\tthis.loading = false\n\t\t},\n\t},\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.system-tags {\n\tdisplay: flex;\n\tflex-direction: column;\n\n\t// Fix issue with AppSidebar styles overwriting NcSelect styles\n\t&__select {\n\t\twidth: 100%;\n\t\t:deep {\n\t\t\t.vs__deselect {\n\t\t\t\tpadding: 0;\n\t\t\t}\n\t\t}\n\t}\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<NcAppSidebar v-if=\"file\"\n\t\tref=\"sidebar\"\n\t\tcy-data-sidebar\n\t\tv-bind=\"appSidebar\"\n\t\t:force-menu=\"true\"\n\t\t@close=\"close\"\n\t\t@update:active=\"setActiveTab\"\n\t\t@[defaultActionListener].stop.prevent=\"onDefaultAction\"\n\t\t@opening=\"handleOpening\"\n\t\t@opened=\"handleOpened\"\n\t\t@closing=\"handleClosing\"\n\t\t@closed=\"handleClosed\">\n\t\t<template v-if=\"fileInfo\" #subname>\n\t\t\t<NcIconSvgWrapper v-if=\"fileInfo.isFavourited\"\n\t\t\t\t:path=\"mdiStar\"\n\t\t\t\t:name=\"t('files', 'Favorite')\"\n\t\t\t\tinline />\n\t\t\t{{ size }}\n\t\t\t<NcDateTime :timestamp=\"fileInfo.mtime\" />\n\t\t</template>\n\n\t\t<!-- TODO: create a standard to allow multiple elements here? -->\n\t\t<template v-if=\"fileInfo\" #description>\n\t\t\t<div class=\"sidebar__description\">\n\t\t\t\t<SystemTags v-if=\"isSystemTagsEnabled && showTagsDefault\"\n\t\t\t\t\tv-show=\"showTags\"\n\t\t\t\t\t:file-id=\"fileInfo.id\"\n\t\t\t\t\t@has-tags=\"value => showTags = value\" />\n\t\t\t\t<LegacyView v-for=\"view in views\"\n\t\t\t\t\t:key=\"view.cid\"\n\t\t\t\t\t:component=\"view\"\n\t\t\t\t\t:file-info=\"fileInfo\" />\n\t\t\t</div>\n\t\t</template>\n\n\t\t<!-- Actions menu -->\n\t\t<template v-if=\"fileInfo\" #secondary-actions>\n\t\t\t<NcActionButton :close-after-click=\"true\"\n\t\t\t\t@click=\"toggleStarred(!fileInfo.isFavourited)\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<NcIconSvgWrapper :path=\"fileInfo.isFavourited ? mdiStarOutline : mdiStar\" />\n\t\t\t\t</template>\n\t\t\t\t{{ fileInfo.isFavourited ? t('files', 'Remove from favorites') : t('files', 'Add to favorites') }}\n\t\t\t</NcActionButton>\n\t\t\t<!-- TODO: create proper api for apps to register actions\n\t\t\tAnd inject themselves here. -->\n\t\t\t<NcActionButton v-if=\"isSystemTagsEnabled\"\n\t\t\t\t:close-after-click=\"true\"\n\t\t\t\ticon=\"icon-tag\"\n\t\t\t\t@click=\"toggleTags\">\n\t\t\t\t{{ t('files', 'Tags') }}\n\t\t\t</NcActionButton>\n\t\t</template>\n\n\t\t<!-- Error display -->\n\t\t<NcEmptyContent v-if=\"error\" icon=\"icon-error\">\n\t\t\t{{ error }}\n\t\t</NcEmptyContent>\n\n\t\t<!-- If fileInfo fetch is complete, render tabs -->\n\t\t<template v-for=\"tab in tabs\" v-else-if=\"fileInfo\">\n\t\t\t<!-- Hide them if we're loading another file but keep them mounted -->\n\t\t\t<SidebarTab v-if=\"tab.enabled(fileInfo)\"\n\t\t\t\tv-show=\"!loading\"\n\t\t\t\t:id=\"tab.id\"\n\t\t\t\t:key=\"tab.id\"\n\t\t\t\t:name=\"tab.name\"\n\t\t\t\t:icon=\"tab.icon\"\n\t\t\t\t:on-mount=\"tab.mount\"\n\t\t\t\t:on-update=\"tab.update\"\n\t\t\t\t:on-destroy=\"tab.destroy\"\n\t\t\t\t:on-scroll-bottom-reached=\"tab.scrollBottomReached\"\n\t\t\t\t:file-info=\"fileInfo\">\n\t\t\t\t<template v-if=\"tab.iconSvg !== undefined\" #icon>\n\t\t\t\t\t<!-- eslint-disable-next-line vue/no-v-html -->\n\t\t\t\t\t<span class=\"svg-icon\" v-html=\"tab.iconSvg\" />\n\t\t\t\t</template>\n\t\t\t</SidebarTab>\n\t\t</template>\n\t</NcAppSidebar>\n</template>\n<script>\nimport { getCurrentUser } from '@nextcloud/auth'\nimport { getCapabilities } from '@nextcloud/capabilities'\nimport { showError } from '@nextcloud/dialogs'\nimport { emit } from '@nextcloud/event-bus'\nimport { File, Folder, formatFileSize } from '@nextcloud/files'\nimport { encodePath } from '@nextcloud/paths'\nimport { generateRemoteUrl, generateUrl } from '@nextcloud/router'\nimport { Type as ShareTypes } from '@nextcloud/sharing'\nimport { mdiStar, mdiStarOutline } from '@mdi/js'\nimport axios from '@nextcloud/axios'\nimport $ from 'jquery'\n\nimport NcAppSidebar from '@nextcloud/vue/dist/Components/NcAppSidebar.js'\nimport NcActionButton from '@nextcloud/vue/dist/Components/NcActionButton.js'\nimport NcDateTime from '@nextcloud/vue/dist/Components/NcDateTime.js'\nimport NcEmptyContent from '@nextcloud/vue/dist/Components/NcEmptyContent.js'\nimport NcIconSvgWrapper from '@nextcloud/vue/dist/Components/NcIconSvgWrapper.js'\n\nimport FileInfo from '../services/FileInfo.js'\nimport LegacyView from '../components/LegacyView.vue'\nimport SidebarTab from '../components/SidebarTab.vue'\nimport SystemTags from '../../../systemtags/src/components/SystemTags.vue'\nimport logger from '../logger.js'\n\nexport default {\n\tname: 'Sidebar',\n\n\tcomponents: {\n\t\tLegacyView,\n\t\tNcActionButton,\n\t\tNcAppSidebar,\n\t\tNcDateTime,\n\t\tNcEmptyContent,\n\t\tNcIconSvgWrapper,\n\t\tSidebarTab,\n\t\tSystemTags,\n\t},\n\n\tsetup() {\n\t\tconst currentUser = getCurrentUser()\n\n\t\t// Non reactive properties\n\t\treturn {\n\t\t\tcurrentUser,\n\n\t\t\tmdiStar,\n\t\t\tmdiStarOutline,\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\t// reactive state\n\t\t\tSidebar: OCA.Files.Sidebar.state,\n\t\t\tshowTags: false,\n\t\t\tshowTagsDefault: true,\n\t\t\terror: null,\n\t\t\tloading: true,\n\t\t\tfileInfo: null,\n\t\t\tisFullScreen: false,\n\t\t\thasLowHeight: false,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t/**\n\t\t * Current filename\n\t\t * This is bound to the Sidebar service and\n\t\t * is used to load a new file\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tfile() {\n\t\t\treturn this.Sidebar.file\n\t\t},\n\n\t\t/**\n\t\t * List of all the registered tabs\n\t\t *\n\t\t * @return {Array}\n\t\t */\n\t\ttabs() {\n\t\t\treturn this.Sidebar.tabs\n\t\t},\n\n\t\t/**\n\t\t * List of all the registered views\n\t\t *\n\t\t * @return {Array}\n\t\t */\n\t\tviews() {\n\t\t\treturn this.Sidebar.views\n\t\t},\n\n\t\t/**\n\t\t * Current user dav root path\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tdavPath() {\n\t\t\tconst user = this.currentUser.uid\n\t\t\treturn generateRemoteUrl(`dav/files/${user}${encodePath(this.file)}`)\n\t\t},\n\n\t\t/**\n\t\t * Current active tab handler\n\t\t *\n\t\t * @return {string} the current active tab\n\t\t */\n\t\tactiveTab() {\n\t\t\treturn this.Sidebar.activeTab\n\t\t},\n\n\t\t/**\n\t\t * File size formatted string\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tsize() {\n\t\t\treturn formatFileSize(this.fileInfo?.size)\n\t\t},\n\n\t\t/**\n\t\t * File background/figure to illustrate the sidebar header\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tbackground() {\n\t\t\treturn this.getPreviewIfAny(this.fileInfo)\n\t\t},\n\n\t\t/**\n\t\t * App sidebar v-binding object\n\t\t *\n\t\t * @return {object}\n\t\t */\n\t\tappSidebar() {\n\t\t\tif (this.fileInfo) {\n\t\t\t\treturn {\n\t\t\t\t\t'data-mimetype': this.fileInfo.mimetype,\n\t\t\t\t\tactive: this.activeTab,\n\t\t\t\t\tbackground: this.background,\n\t\t\t\t\tclass: {\n\t\t\t\t\t\t'app-sidebar--has-preview': this.fileInfo.hasPreview && !this.isFullScreen,\n\t\t\t\t\t\t'app-sidebar--full': this.isFullScreen,\n\t\t\t\t\t},\n\t\t\t\t\tcompact: this.hasLowHeight || !this.fileInfo.hasPreview || this.isFullScreen,\n\t\t\t\t\tloading: this.loading,\n\t\t\t\t\tname: this.fileInfo.name,\n\t\t\t\t\ttitle: this.fileInfo.name,\n\t\t\t\t}\n\t\t\t} else if (this.error) {\n\t\t\t\treturn {\n\t\t\t\t\tkey: 'error', // force key to re-render\n\t\t\t\t\tsubname: '',\n\t\t\t\t\tname: '',\n\t\t\t\t\tclass: {\n\t\t\t\t\t\t'app-sidebar--full': this.isFullScreen,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}\n\t\t\t// no fileInfo yet, showing empty data\n\t\t\treturn {\n\t\t\t\tloading: this.loading,\n\t\t\t\tsubname: '',\n\t\t\t\tname: '',\n\t\t\t\tclass: {\n\t\t\t\t\t'app-sidebar--full': this.isFullScreen,\n\t\t\t\t},\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Default action object for the current file\n\t\t *\n\t\t * @return {object}\n\t\t */\n\t\tdefaultAction() {\n\t\t\treturn this.fileInfo\n\t\t\t\t&& OCA.Files && OCA.Files.App && OCA.Files.App.fileList\n\t\t\t\t&& OCA.Files.App.fileList.fileActions\n\t\t\t\t&& OCA.Files.App.fileList.fileActions.getDefaultFileAction\n\t\t\t\t&& OCA.Files.App.fileList\n\t\t\t\t\t.fileActions.getDefaultFileAction(this.fileInfo.mimetype, this.fileInfo.type, OC.PERMISSION_READ)\n\n\t\t},\n\n\t\t/**\n\t\t * Dynamic header click listener to ensure\n\t\t * nothing is listening for a click if there\n\t\t * is no default action\n\t\t *\n\t\t * @return {string|null}\n\t\t */\n\t\tdefaultActionListener() {\n\t\t\treturn this.defaultAction ? 'figure-click' : null\n\t\t},\n\n\t\tisSystemTagsEnabled() {\n\t\t\treturn getCapabilities()?.systemtags?.enabled === true\n\t\t},\n\t},\n\tcreated() {\n\t\twindow.addEventListener('resize', this.handleWindowResize)\n\t\tthis.handleWindowResize()\n\t},\n\tbeforeDestroy() {\n\t\twindow.removeEventListener('resize', this.handleWindowResize)\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * Can this tab be displayed ?\n\t\t *\n\t\t * @param {object} tab a registered tab\n\t\t * @return {boolean}\n\t\t */\n\t\tcanDisplay(tab) {\n\t\t\treturn tab.enabled(this.fileInfo)\n\t\t},\n\t\tresetData() {\n\t\t\tthis.error = null\n\t\t\tthis.fileInfo = null\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tif (this.$refs.tabs) {\n\t\t\t\t\tthis.$refs.tabs.updateTabs()\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\n\t\tgetPreviewIfAny(fileInfo) {\n\t\t\tif (fileInfo?.hasPreview && !this.isFullScreen) {\n\t\t\t\tconst etag = fileInfo?.etag || ''\n\t\t\t\treturn generateUrl(`/core/preview?fileId=${fileInfo.id}&x=${screen.width}&y=${screen.height}&a=true&v=${etag.slice(0, 6)}`)\n\t\t\t}\n\t\t\treturn this.getIconUrl(fileInfo)\n\t\t},\n\n\t\t/**\n\t\t * Copied from https://github.com/nextcloud/server/blob/16e0887ec63591113ee3f476e0c5129e20180cde/apps/files/js/filelist.js#L1377\n\t\t * TODO: We also need this as a standalone library\n\t\t *\n\t\t * @param {object} fileInfo the fileinfo\n\t\t * @return {string} Url to the icon for mimeType\n\t\t */\n\t\tgetIconUrl(fileInfo) {\n\t\t\tconst mimeType = fileInfo?.mimetype || 'application/octet-stream'\n\t\t\tif (mimeType === 'httpd/unix-directory') {\n\t\t\t\t// use default folder icon\n\t\t\t\tif (fileInfo.mountType === 'shared' || fileInfo.mountType === 'shared-root') {\n\t\t\t\t\treturn OC.MimeType.getIconUrl('dir-shared')\n\t\t\t\t} else if (fileInfo.mountType === 'external-root') {\n\t\t\t\t\treturn OC.MimeType.getIconUrl('dir-external')\n\t\t\t\t} else if (fileInfo.mountType !== undefined && fileInfo.mountType !== '') {\n\t\t\t\t\treturn OC.MimeType.getIconUrl('dir-' + fileInfo.mountType)\n\t\t\t\t} else if (fileInfo.shareTypes && (\n\t\t\t\t\tfileInfo.shareTypes.indexOf(ShareTypes.SHARE_TYPE_LINK) > -1\n\t\t\t\t\t|| fileInfo.shareTypes.indexOf(ShareTypes.SHARE_TYPE_EMAIL) > -1)\n\t\t\t\t) {\n\t\t\t\t\treturn OC.MimeType.getIconUrl('dir-public')\n\t\t\t\t} else if (fileInfo.shareTypes && fileInfo.shareTypes.length > 0) {\n\t\t\t\t\treturn OC.MimeType.getIconUrl('dir-shared')\n\t\t\t\t}\n\t\t\t\treturn OC.MimeType.getIconUrl('dir')\n\t\t\t}\n\t\t\treturn OC.MimeType.getIconUrl(mimeType)\n\t\t},\n\n\t\t/**\n\t\t * Set current active tab\n\t\t *\n\t\t * @param {string} id tab unique id\n\t\t */\n\t\tsetActiveTab(id) {\n\t\t\tOCA.Files.Sidebar.setActiveTab(id)\n\t\t\tthis.tabs.forEach(tab => {\n\t\t\t\ttry {\n\t\t\t\t\ttab.setIsActive(id === tab.id)\n\t\t\t\t} catch (error) {\n\t\t\t\t\tlogger.error('Error while setting tab active state', { error, id: tab.id, tab })\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\n\t\t/**\n\t\t * Toggle favourite state\n\t\t * TODO: better implementation\n\t\t *\n\t\t * @param {boolean} state favourited or not\n\t\t */\n\t\tasync toggleStarred(state) {\n\t\t\ttry {\n\t\t\t\tawait axios({\n\t\t\t\t\tmethod: 'PROPPATCH',\n\t\t\t\t\turl: this.davPath,\n\t\t\t\t\tdata: `<?xml version=\"1.0\"?>\n\t\t\t\t\t\t<d:propertyupdate xmlns:d=\"DAV:\" xmlns:oc=\"http://owncloud.org/ns\">\n\t\t\t\t\t\t${state ? '<d:set>' : '<d:remove>'}\n\t\t\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t\t\t<oc:favorite>1</oc:favorite>\n\t\t\t\t\t\t\t</d:prop>\n\t\t\t\t\t\t${state ? '</d:set>' : '</d:remove>'}\n\t\t\t\t\t\t</d:propertyupdate>`,\n\t\t\t\t})\n\n\t\t\t\t/**\n\t\t\t\t * TODO: adjust this when the Sidebar is finally using File/Folder classes\n\t\t\t\t * @see https://github.com/nextcloud/server/blob/8a75cb6e72acd42712ab9fea22296aa1af863ef5/apps/files/src/views/favorites.ts#L83-L115\n\t\t\t\t */\n\t\t\t\tconst isDir = this.fileInfo.type === 'dir'\n\t\t\t\tconst Node = isDir ? Folder : File\n\t\t\t\temit(state ? 'files:favorites:added' : 'files:favorites:removed', new Node({\n\t\t\t\t\tfileid: this.fileInfo.id,\n\t\t\t\t\tsource: this.davPath,\n\t\t\t\t\troot: `/files/${getCurrentUser().uid}`,\n\t\t\t\t\tmime: isDir ? undefined : this.fileInfo.mimetype,\n\t\t\t\t}))\n\n\t\t\t\tthis.fileInfo.isFavourited = state\n\t\t\t} catch (error) {\n\t\t\t\tshowError(t('files', 'Unable to change the favourite state of the file'))\n\t\t\t\tlogger.error('Unable to change favourite state', { error })\n\t\t\t}\n\t\t},\n\n\t\tonDefaultAction() {\n\t\t\tif (this.defaultAction) {\n\t\t\t\t// generate fake context\n\t\t\t\tthis.defaultAction.action(this.fileInfo.name, {\n\t\t\t\t\tfileInfo: this.fileInfo,\n\t\t\t\t\tdir: this.fileInfo.dir,\n\t\t\t\t\tfileList: OCA.Files.App.fileList,\n\t\t\t\t\t$file: $('body'),\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Toggle the tags selector\n\t\t */\n\t\ttoggleTags() {\n\t\t\tthis.showTagsDefault = this.showTags = !this.showTags\n\t\t},\n\n\t\t/**\n\t\t * Open the sidebar for the given file\n\t\t *\n\t\t * @param {string} path the file path to load\n\t\t * @return {Promise}\n\t\t * @throws {Error} loading failure\n\t\t */\n\t\tasync open(path) {\n\t\t\tif (!path || path.trim() === '') {\n\t\t\t\tthrow new Error(`Invalid path '${path}'`)\n\t\t\t}\n\n\t\t\t// Only focus the tab when the selected file/tab is changed in already opened sidebar\n\t\t\t// Focusing the sidebar on first file open is handled by NcAppSidebar\n\t\t\tconst focusTabAfterLoad = !!this.Sidebar.file\n\n\t\t\t// update current opened file\n\t\t\tthis.Sidebar.file = path\n\n\t\t\t// reset data, keep old fileInfo to not reload all tabs and just hide them\n\t\t\tthis.error = null\n\t\t\tthis.loading = true\n\n\t\t\ttry {\n\t\t\t\tthis.fileInfo = await FileInfo(this.davPath)\n\t\t\t\t// adding this as fallback because other apps expect it\n\t\t\t\tthis.fileInfo.dir = this.file.split('/').slice(0, -1).join('/')\n\n\t\t\t\t// DEPRECATED legacy views\n\t\t\t\t// TODO: remove\n\t\t\t\tthis.views.forEach(view => {\n\t\t\t\t\tview.setFileInfo(this.fileInfo)\n\t\t\t\t})\n\n\t\t\t\tawait this.$nextTick()\n\n\t\t\t\tthis.setActiveTab(this.Sidebar.activeTab || this.tabs[0].id)\n\n\t\t\t\tthis.loading = false\n\n\t\t\t\tawait this.$nextTick()\n\n\t\t\t\tif (focusTabAfterLoad) {\n\t\t\t\t\tthis.$refs.sidebar.focusActiveTabContent()\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tthis.loading = false\n\t\t\t\tthis.error = t('files', 'Error while loading the file data')\n\t\t\t\tconsole.error('Error while loading the file data', error)\n\n\t\t\t\tthrow new Error(error)\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Close the sidebar\n\t\t */\n\t\tclose() {\n\t\t\tthis.Sidebar.file = ''\n\t\t\tthis.showTags = false\n\t\t\tthis.resetData()\n\t\t},\n\n\t\t/**\n\t\t * Allow to set the Sidebar as fullscreen from OCA.Files.Sidebar\n\t\t *\n\t\t * @param {boolean} isFullScreen - Whether or not to render the Sidebar in fullscreen.\n\t\t */\n\t\tsetFullScreenMode(isFullScreen) {\n\t\t\tthis.isFullScreen = isFullScreen\n\t\t\tif (isFullScreen) {\n\t\t\t\tdocument.querySelector('#content')?.classList.add('with-sidebar--full')\n\t\t\t\t\t|| document.querySelector('#content-vue')?.classList.add('with-sidebar--full')\n\t\t\t} else {\n\t\t\t\tdocument.querySelector('#content')?.classList.remove('with-sidebar--full')\n\t\t\t\t\t|| document.querySelector('#content-vue')?.classList.remove('with-sidebar--full')\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Allow to set whether tags should be shown by default from OCA.Files.Sidebar\n\t\t *\n\t\t * @param {boolean} showTagsDefault - Whether or not to show the tags by default.\n\t\t */\n\t\tsetShowTagsDefault(showTagsDefault) {\n\t\t\tthis.showTagsDefault = showTagsDefault\n\t\t},\n\n\t\t/**\n\t\t * Emit SideBar events.\n\t\t */\n\t\thandleOpening() {\n\t\t\temit('files:sidebar:opening')\n\t\t},\n\t\thandleOpened() {\n\t\t\temit('files:sidebar:opened')\n\t\t},\n\t\thandleClosing() {\n\t\t\temit('files:sidebar:closing')\n\t\t},\n\t\thandleClosed() {\n\t\t\temit('files:sidebar:closed')\n\t\t},\n\t\thandleWindowResize() {\n\t\t\tthis.hasLowHeight = document.documentElement.clientHeight < 1024\n\t\t},\n\t},\n}\n</script>\n<style lang=\"scss\" scoped>\n.app-sidebar {\n\t&--has-preview:deep {\n\t\t.app-sidebar-header__figure {\n\t\t\tbackground-size: cover;\n\t\t}\n\n\t\t&[data-mimetype=\"text/plain\"],\n\t\t&[data-mimetype=\"text/markdown\"] {\n\t\t\t.app-sidebar-header__figure {\n\t\t\t\tbackground-size: contain;\n\t\t\t}\n\t\t}\n\t}\n\n\t&--full {\n\t\tposition: fixed !important;\n\t\tz-index: 2025 !important;\n\t\ttop: 0 !important;\n\t\theight: 100% !important;\n\t}\n\n\t:deep {\n\t\t.app-sidebar-header__description {\n\t\t\tmargin: 0 16px 4px 16px !important;\n\t\t}\n\t}\n\n\t.svg-icon {\n\t\t::v-deep svg {\n\t\t\twidth: 20px;\n\t\t\theight: 20px;\n\t\t\tfill: currentColor;\n\t\t}\n\t}\n}\n\n.sidebar__description {\n\tdisplay: flex;\n\tflex-direction: column;\n\twidth: 100%;\n\tgap: 8px 0;\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nexport default class Sidebar {\n\n\t_state\n\n\tconstructor() {\n\t\t// init empty state\n\t\tthis._state = {}\n\n\t\t// init default values\n\t\tthis._state.tabs = []\n\t\tthis._state.views = []\n\t\tthis._state.file = ''\n\t\tthis._state.activeTab = ''\n\t\tconsole.debug('OCA.Files.Sidebar initialized')\n\t}\n\n\t/**\n\t * Get the sidebar state\n\t *\n\t * @readonly\n\t * @memberof Sidebar\n\t * @return {object} the data state\n\t */\n\tget state() {\n\t\treturn this._state\n\t}\n\n\t/**\n\t * Register a new tab view\n\t *\n\t * @memberof Sidebar\n\t * @param {object} tab a new unregistered tab\n\t * @return {boolean}\n\t */\n\tregisterTab(tab) {\n\t\tconst hasDuplicate = this._state.tabs.findIndex(check => check.id === tab.id) > -1\n\t\tif (!hasDuplicate) {\n\t\t\tthis._state.tabs.push(tab)\n\t\t\treturn true\n\t\t}\n\t\tconsole.error(`An tab with the same id ${tab.id} already exists`, tab)\n\t\treturn false\n\t}\n\n\tregisterSecondaryView(view) {\n\t\tconst hasDuplicate = this._state.views.findIndex(check => check.id === view.id) > -1\n\t\tif (!hasDuplicate) {\n\t\t\tthis._state.views.push(view)\n\t\t\treturn true\n\t\t}\n\t\tconsole.error('A similar view already exists', view)\n\t\treturn false\n\t}\n\n\t/**\n\t * Return current opened file\n\t *\n\t * @memberof Sidebar\n\t * @return {string} the current opened file\n\t */\n\tget file() {\n\t\treturn this._state.file\n\t}\n\n\t/**\n\t * Set the current visible sidebar tab\n\t *\n\t * @memberof Sidebar\n\t * @param {string} id the tab unique id\n\t */\n\tsetActiveTab(id) {\n\t\tthis._state.activeTab = id\n\t}\n\n}\n","'use strict';\nconst {XMLParser, XMLValidator} = require('fast-xml-parser');\n\nconst isSvg = input => {\n\tif (input === undefined || input === null) {\n\t\treturn false;\n\t}\n\n\tinput = input.toString().trim();\n\n\tif (input.length === 0) {\n\t\treturn false;\n\t}\n\n\t// Has to be `!==` as it can also return an object with error info.\n\tif (XMLValidator.validate(input) !== true) {\n\t\treturn false;\n\t}\n\n\tlet jsonObject;\n\tconst parser = new XMLParser();\n\n\ttry {\n\t\tjsonObject = parser.parse(input);\n\t} catch (_) {\n\t\treturn false;\n\t}\n\n\tif (!jsonObject) {\n\t\treturn false;\n\t}\n\n\tif (!('svg' in jsonObject)) {\n\t\treturn false;\n\t}\n\n\treturn true;\n};\n\nmodule.exports = isSvg;\n// TODO: Remove this for the next major release\nmodule.exports.default = isSvg;\n","import { Buffer } from 'buffer';\nimport isSvg from 'is-svg';\n\nconst readAsText = (svg) => new Promise((resolve) => {\n    if (!isFile(svg)) {\n        resolve(svg.toString('utf-8'));\n    }\n    else {\n        const fileReader = new FileReader();\n        fileReader.onload = () => {\n            resolve(fileReader.result);\n        };\n        fileReader.readAsText(svg);\n    }\n});\nconst isFile = (obj) => {\n    return obj.size !== undefined;\n};\nconst sanitizeSVG = async (svg) => {\n    if (!svg) {\n        throw new Error('Not an svg');\n    }\n    let svgText = '';\n    if (Buffer.isBuffer(svg) || svg instanceof File) {\n        svgText = await readAsText(svg);\n    }\n    else {\n        svgText = svg;\n    }\n    if (!isSvg(svgText)) {\n        throw new Error('Not an svg');\n    }\n    const div = document.createElement('div');\n    div.innerHTML = svgText;\n    const svgEl = div.firstElementChild;\n    const attributes = Array.from(svgEl.attributes).map(({ name }) => name);\n    const hasScriptAttr = !!attributes.find((attr) => attr.startsWith('on'));\n    const scripts = svgEl.getElementsByTagName('script');\n    return scripts.length === 0 && !hasScriptAttr ? svg : null;\n};\n\nexport { sanitizeSVG };\n//# sourceMappingURL=index.esm.js.map\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { sanitizeSVG } from '@skjnldsv/sanitize-svg'\n\nexport default class Tab {\n\n\t_id\n\t_name\n\t_icon\n\t_iconSvgSanitized\n\t_mount\n\t_setIsActive\n\t_update\n\t_destroy\n\t_enabled\n\t_scrollBottomReached\n\n\t/**\n\t * Create a new tab instance\n\t *\n\t * @param {object} options destructuring object\n\t * @param {string} options.id the unique id of this tab\n\t * @param {string} options.name the translated tab name\n\t * @param {?string} options.icon the icon css class\n\t * @param {?string} options.iconSvg the icon in svg format\n\t * @param {Function} options.mount function to mount the tab\n\t * @param {Function} [options.setIsActive] function to forward the active state of the tab\n\t * @param {Function} options.update function to update the tab\n\t * @param {Function} options.destroy function to destroy the tab\n\t * @param {Function} [options.enabled] define conditions whether this tab is active. Must returns a boolean\n\t * @param {Function} [options.scrollBottomReached] executed when the tab is scrolled to the bottom\n\t */\n\tconstructor({ id, name, icon, iconSvg, mount, setIsActive, update, destroy, enabled, scrollBottomReached } = {}) {\n\t\tif (enabled === undefined) {\n\t\t\tenabled = () => true\n\t\t}\n\t\tif (scrollBottomReached === undefined) {\n\t\t\tscrollBottomReached = () => { }\n\t\t}\n\n\t\t// Sanity checks\n\t\tif (typeof id !== 'string' || id.trim() === '') {\n\t\t\tthrow new Error('The id argument is not a valid string')\n\t\t}\n\t\tif (typeof name !== 'string' || name.trim() === '') {\n\t\t\tthrow new Error('The name argument is not a valid string')\n\t\t}\n\t\tif ((typeof icon !== 'string' || icon.trim() === '') && typeof iconSvg !== 'string') {\n\t\t\tthrow new Error('Missing valid string for icon or iconSvg argument')\n\t\t}\n\t\tif (typeof mount !== 'function') {\n\t\t\tthrow new Error('The mount argument should be a function')\n\t\t}\n\t\tif (setIsActive !== undefined && typeof setIsActive !== 'function') {\n\t\t\tthrow new Error('The setIsActive argument should be a function')\n\t\t}\n\t\tif (typeof update !== 'function') {\n\t\t\tthrow new Error('The update argument should be a function')\n\t\t}\n\t\tif (typeof destroy !== 'function') {\n\t\t\tthrow new Error('The destroy argument should be a function')\n\t\t}\n\t\tif (typeof enabled !== 'function') {\n\t\t\tthrow new Error('The enabled argument should be a function')\n\t\t}\n\t\tif (typeof scrollBottomReached !== 'function') {\n\t\t\tthrow new Error('The scrollBottomReached argument should be a function')\n\t\t}\n\n\t\tthis._id = id\n\t\tthis._name = name\n\t\tthis._icon = icon\n\t\tthis._mount = mount\n\t\tthis._setIsActive = setIsActive\n\t\tthis._update = update\n\t\tthis._destroy = destroy\n\t\tthis._enabled = enabled\n\t\tthis._scrollBottomReached = scrollBottomReached\n\n\t\tif (typeof iconSvg === 'string') {\n\t\t\tsanitizeSVG(iconSvg)\n\t\t\t\t.then(sanitizedSvg => {\n\t\t\t\t\tthis._iconSvgSanitized = sanitizedSvg\n\t\t\t\t})\n\t\t}\n\n\t}\n\n\tget id() {\n\t\treturn this._id\n\t}\n\n\tget name() {\n\t\treturn this._name\n\t}\n\n\tget icon() {\n\t\treturn this._icon\n\t}\n\n\tget iconSvg() {\n\t\treturn this._iconSvgSanitized\n\t}\n\n\tget mount() {\n\t\treturn this._mount\n\t}\n\n\tget setIsActive() {\n\t\treturn this._setIsActive || (() => undefined)\n\t}\n\n\tget update() {\n\t\treturn this._update\n\t}\n\n\tget destroy() {\n\t\treturn this._destroy\n\t}\n\n\tget enabled() {\n\t\treturn this._enabled\n\t}\n\n\tget scrollBottomReached() {\n\t\treturn this._scrollBottomReached\n\t}\n\n}\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport Vue from 'vue'\nimport { translate as t } from '@nextcloud/l10n'\n\nimport SidebarView from './views/Sidebar.vue'\nimport Sidebar from './services/Sidebar.js'\nimport Tab from './models/Tab.js'\n\nVue.prototype.t = t\n\n// Init Sidebar Service\nif (!window.OCA.Files) {\n\twindow.OCA.Files = {}\n}\nObject.assign(window.OCA.Files, { Sidebar: new Sidebar() })\nObject.assign(window.OCA.Files.Sidebar, { Tab })\n\nwindow.addEventListener('DOMContentLoaded', function() {\n\tconst contentElement = document.querySelector('body > .content')\n\t\t|| document.querySelector('body > #content')\n\n\t// Make sure we have a proper layout\n\tif (contentElement) {\n\t\t// Make sure we have a mountpoint\n\t\tif (!document.getElementById('app-sidebar')) {\n\t\t\tconst sidebarElement = document.createElement('div')\n\t\t\tsidebarElement.id = 'app-sidebar'\n\t\t\tcontentElement.appendChild(sidebarElement)\n\t\t}\n\t}\n\n\t// Init vue app\n\tconst View = Vue.extend(SidebarView)\n\tconst AppSidebar = new View({\n\t\tname: 'SidebarRoot',\n\t})\n\tAppSidebar.$mount('#app-sidebar')\n\twindow.OCA.Files.Sidebar.open = AppSidebar.open\n\twindow.OCA.Files.Sidebar.close = AppSidebar.close\n\twindow.OCA.Files.Sidebar.setFullScreenMode = AppSidebar.setFullScreenMode\n\twindow.OCA.Files.Sidebar.setShowTagsDefault = AppSidebar.setShowTagsDefault\n})\n"],"names":["XmlNode","tagname","key","val","node","xmlNode","util","require$$0","readDocType","xmlData","i","entities","angleBracketsCount","hasBody","comment","exp","isEntity","readEntityExp","validateEntityName","isElement","isAttlist","isNotation","isComment","e","entityName","startChar","name","DocTypeReader","require$$1","require$$2","toNumber","require$$3","OrderedObjParser$1","options","addExternalEntities","parseXml","parseTextData","resolveNameSpace","buildAttributesMap","isItStopNode","replaceEntitiesValue","readStopNodeData","saveTextToParentTag","addChild","externalEntities","entKeys","ent","tagName","jPath","dontTrim","hasAttributes","isLeafNode","escapeEntities","newval","parseValue","tags","prefix","attrsRegx","attrStr","matches","len","attrs","attrName","oldVal","aName","newVal","attrCollection","xmlObj","currentNode","textData","closeIndex","findClosingIndex","colonIndex","lastTagName","propIndex","tagData","readTagExp","childNode","endIndex","result","tagExp","rawTagName","attrExpPresent","lastTag","tagContent","entity","stopNodes","currentTagName","allNodesExp","stopNodePath","stopNodeExp","tagExpWithClosingIndex","closingChar","attrBoundary","index","ch","str","errMsg","closingIndex","removeNSPrefix","separatorIndex","startIndex","openTagCount","shouldParse","OrderedObjParser_1","OrderedObjParser","buildOptions","prettify","validator","XMLParser$2","validationOption","orderedObjParser","orderedResult","value","XMLParser_1","XMLParser","XMLBuilder","fxp","FileInfo","url","response","axios","davGetDefaultPropfind","file","fileInfo","_sfc_main","NcAppSidebarTab","NcEmptyContent","newFile","oldFile","fetchTagsForFile","fileId","path","davClient","fetchTagsPayload","parseTags","error","logger","createTagForFile","tag","tagToCreate","formatTag","tagId","createTag","tagToSet","setTagForFile","tagToPut","deleteTagForFile","_sfc_main$1","Vue","NcLoadingIcon","NcSelectTags","fetchTags","lastUsedOrder","fetchLastUsedTagIds","lastUsedTags","remainingTags","sortByLastUsed","a","b","showError","t","newDisplayName","id","displayName","baseTag","defaultBaseTag","selectedTags","selectedTag","sortToFront","createdTag","LegacyView","NcActionButton","NcAppSidebar","NcDateTime","NcIconSvgWrapper","SidebarTab","SystemTags","getCurrentUser","mdiStar","mdiStarOutline","user","generateRemoteUrl","encodePath","formatFileSize","_a","getCapabilities","tab","etag","generateUrl","mimeType","ShareTypes","state","isDir","Node","Folder","File","emit","$","focusTabAfterLoad","view","isFullScreen","_b","_c","_d","showTagsDefault","Sidebar","__publicField","check","XMLValidator","isSvg","input","jsonObject","parser","isSvgModule","readAsText","svg","resolve","isFile","fileReader","obj","sanitizeSVG","svgText","Buffer","div","svgEl","hasScriptAttr","attr","Tab","icon","iconSvg","mount","setIsActive","update","destroy","enabled","scrollBottomReached","sanitizedSvg","contentElement","sidebarElement","View","SidebarView","AppSidebar"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,12,13]}