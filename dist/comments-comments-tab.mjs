const __vite__fileDeps=["./chunks/ActivityCommentAction-CD6Sz7HA.mjs","./core-common.mjs","./chunks/CommentView-BScxt2F_.mjs","./chunks/preload-helper-BG02UnR2.mjs","./chunks/icons-DENytzON.mjs","./chunks/index-7XKGWWeV.mjs","./chunks/_plugin-vue2_normalizer-VrK6B12S-B9aYHv6f.mjs","./chunks/GetComments-BcCPPtc4.mjs","./chunks/index-BxKJ4nfQ.mjs","./chunks/json2xml-BD0x8Z3S.mjs","./chunks/logger-Dp4fPXsK.mjs","./chunks/ActivityCommentEntry-9wQKQQIQ.mjs"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
/*! third party licenses: dist/vendor.LICENSE.txt */
import{M as A}from"./chunks/icons-DENytzON.mjs";import{aW as c,c0 as y}from"./core-common.mjs";import{_ as l}from"./chunks/preload-helper-BG02UnR2.mjs";import{m as b}from"./chunks/index-BB6ZXwkp.mjs";import{l as s}from"./chunks/logger-Dp4fPXsK.mjs";import{g as v}from"./chunks/GetComments-BcCPPtc4.mjs";import"./chunks/index-BxKJ4nfQ.mjs";import"./chunks/json2xml-BD0x8Z3S.mjs";let m,a;function O(){window.OCA.Activity.registerSidebarAction({mount:async(e,{context:n,fileInfo:o,reload:i})=>{if(!m){const{default:r}=await l(()=>import("./chunks/ActivityCommentAction-CD6Sz7HA.mjs"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]),import.meta.url);m=c.extend(r)}a=new m({parent:n,propsData:{reloadCallback:i,resourceId:o.id}}),a.$mount(e),s.info("Comments plugin mounted in Activity sidebar action",{fileInfo:o})},unmount:()=>{a&&a.$destroy()}}),window.OCA.Activity.registerSidebarEntries(async({fileInfo:e,limit:n,offset:o})=>{const{data:i}=await v({resourceType:"files",resourceId:e.id},{limit:n,offset:o});s.debug("Loaded comments",{fileInfo:e,comments:i});const{default:r}=await l(()=>import("./chunks/ActivityCommentEntry-9wQKQQIQ.mjs"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,10]),import.meta.url),p=c.extend(r);return i.map(d=>({timestamp:b(d.props.creationDateTime).toDate().getTime(),mount(f,{context:w,reload:C}){this._CommentsViewInstance=new p({parent:w,propsData:{comment:d,resourceId:e.id,reloadCallback:C}}),this._CommentsViewInstance.$mount(f)},unmount(){this._CommentsViewInstance.$destroy()}}))}),window.OCA.Activity.registerSidebarFilter(e=>e.type!=="comments"),s.info("Comments plugin registered for Activity sidebar action")}var u;if(y("comments","activityEnabled",!1)&&((u=OCA==null?void 0:OCA.Activity)==null?void 0:u.registerSidebarAction)!==void 0)window.addEventListener("DOMContentLoaded",function(){O()});else{let e=null;const n=new OCA.Files.Sidebar.Tab({id:"comments",name:t("comments","Comments"),iconSvg:A,async mount(o,i,r){e&&e.$destroy(),e=new OCA.Comments.View("files",{parent:r,propsData:{resourceId:i.id}}),await e.update(i.id),e.$mount(o)},update(o){e.update(o.id)},destroy(){e.$destroy(),e=null},scrollBottomReached(){e.onScrollBottomReached()}});window.addEventListener("DOMContentLoaded",function(){OCA.Files&&OCA.Files.Sidebar&&OCA.Files.Sidebar.registerTab(n)})}
